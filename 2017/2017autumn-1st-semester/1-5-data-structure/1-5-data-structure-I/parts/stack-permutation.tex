%%%%%%%%%%%%%%%
\begin{frame}{}
  \centerline{\LARGE Stackable Permutations}

  \vspace{0.40cm}
  \pause
  \fignocaption{width = 0.45\textwidth}{figs/hard}
\end{frame}
%%%%%%%%%%%%%%%

% \begin{description}[\texttt{push(X, S)}:]
%   \item[\texttt{read(X)}:] $\texttt{in >> } X$
%   \item[\texttt{print(X)}:] $\texttt{out << } X$
%   \item[\texttt{push(X, S)}:] $S \Leftarrow X$
%   \item[\texttt{pop(X, S)}:] $X \Leftarrow S$
% \end{description}

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{definition}[Stackable Permutations]
    \uncover<2->{
      \[
	\fbox{$\texttt{out} = (a_1, \cdots, a_n) \blue{\xleftarrow[X = 0]{S = \emptyset}} \texttt{in} = (1, \cdots, n)$}
      \]
    }

    \fignocaption{width = 0.65\textwidth}{figs/stack-perm-x}
  \end{definition}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{definition}[Stackable Permutations]
    \fignocaption{width = 0.50\textwidth}{figs/stack-perm-x}
  \end{definition}

  \vspace{0.40cm}
  \pause
  \red{$Q_1:$} \cyan{Meaning} of ``\texttt{read, print, push, pop}''?

  \vspace{0.20cm}
  \pause
  \red{$Q_2:$} Using \cyan{only} ``\texttt{read, print, push, pop}''?
    \[
      a == X  \pause \qquad a > X \; (a < X) \pause \qquad \texttt{top}(S)
    \]
\end{frame}
%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{DH 2.12: Stackable Permutations}
    \begin{enumerate}[(a)]
      \item \redoverlay{\bf Show}{2-} that the following permutations \emph{\blue{are}} stackable:
	\begin{enumerate}[(i)]
	  \item $(3, 2, 1)$
	  \item \textcolor{gray}{$(3, 4, 2, 1)$}
	  \item $(3, 5, 7, 6, 8, 4, 9, 2, 10, 1)$
	\end{enumerate}
    \end{enumerate}
  \end{exampleblock}

  \vspace{0.50cm}
  \uncover<3->{\fignocaption{width = 0.40\textwidth}{figs/no-choice}}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}[fragile]{}
  \begin{exampleblock}{DH 2.13: Stackable Permutations Checking Algorithm}
    To check whether a given permutation can be obtained by a stack.

    \centerline{\texttt{read} \quad \texttt{print} \quad \texttt{push} \quad \texttt{pop} \quad \blue{\texttt{is-empty}}}
  \end{exampleblock}


  % // not necessary!
  % if ('a' == X)
  %   print(X) 
  %   break
  \begin{lstlisting}[style = Cstyle]
              X = 0    S = $\emptyset$    in != EOF
  \end{lstlisting}

  \begin{columns}
    \pause
    \column{0.45\textwidth}
      \begin{lstlisting}[style = Cstyle]
foreach 'a' in out:
  if (! is-empty(S) 
      && 'a' == top(S))
    pop(S, X)
    print(X)
    continue
  else $\cdots$ // T.B.C
      \end{lstlisting}
    \pause
    \column{0.45\textwidth}
      \begin{lstlisting}[style = Cstyle]
  else // T.B.C
    while (in != EOF)
      read(X)
      if (X == 'a')
        print(X)
        continue
      else
        push(X, S)
    |\redoverlay{ERR}{4-}|  |\uncover<4->{\red{// How???}}|
      \end{lstlisting}
  \end{columns}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{DH 2.12: Stackable Permutations}
    \begin{enumerate}[(a)]
      \setcounter{enumi}{1}
    \item \redoverlay{\bf Prove}{2-} that the following permutations are \emph{\blue{not}} stackable:
	\begin{enumerate}[(i)]
	  \item $(3, 1, 2)$
	  \item $(4, 5, 3, 7, 2, 1, 6)$
	\end{enumerate}
    \end{enumerate}
  \end{exampleblock}

  \uncover<3->{
    \[
      (\red{3}, \red{1}, \red{2})
    \]

    \[
      (4, 5, 3, \red{7}, \red{2}, 1, \red{6})
    \]
  }

  \uncover<4->{
    \[
      \fbox{$\texttt{out} = \cdots a_i \cdots a_j \cdots a_k: i < j < k \land a_j < a_k < a_i$}
    \]
  }

  \uncover<5->{
    \[
      312\text{-Pattern}
    \]
  }
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}[fragile]{}
  \begin{theorem}[Stackable Permutations]
    A permutation $(a_1, \cdots, a_n)$ is stackable $\iff$ it is not the case that
    \[
      312\text{\it -Pattern}: \fbox{$\texttt{\it out} = \cdots a_i \cdots a_j \cdots a_k: i < j < k \land a_j < a_k < a_i$}
    \]
  \end{theorem}

  \vspace{0.30cm}
  \pause
  \begin{proof}
    \fignocaption{width = 0.40\textwidth}{figs/no-proof}
  \end{proof}

  % \pause
  % \begin{proof}
  %   \begin{columns}
  %     \column{0.45\textwidth}
  %       \[
  %         \text{stackable} \Longrightarrow \nexists \;312\text{-Pattern} 
  %       \]
  %       \pause
  %       \[
  %         \blue{312\text{-Pattern} \Longrightarrow \text{non-stackable}}
  %       \]
  %       \pause
  %       \[
  %         \red{\forall \;\text{algorithms}}
  %       \]
  %     \column{0.45\textwidth}
  %       \pause
  %       \[
  %         \blue{\nexists \;312\text{-Pattern} \Longrightarrow \text{stackable}}
  %       \]
  %       \pause
  %       \[
  %         \red{\exists \;\text{algorithm}}
  %       \]
  %   \end{columns}
  % \end{proof}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{theorem}[Stackable Permutations]
%     A permutation $(a_1, \cdots, a_n)$ is stackable \blue{(on the model $S$)} $\iff$ it is not the case that
%     \[
%       312\text{\it -Pattern}: \fbox{$\texttt{\it out} = \cdots a_i \cdots a_j \cdots a_k: i < j < k \land a_j < a_k < a_i$}
%     \]
%   \end{theorem}
% 
%   \vspace{0.30cm}
%   \begin{proof}[$312\text{-Pattern} \Longrightarrow \text{non-stackable}$]
%     \begin{description}[$a_j < a_k < a_i$:]
%       \item[$a_j < a_k < a_i$:] When $a_i$ is poped, $a_j$ and $a_k$ are on the stack.
%       \item[$j < k$:] $a_j$ is above $a_k$ on the stack.
%       \item[$a_j < a_k$:] Contradiction.
%     \end{description}
%   \end{proof}
% \end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
% \begin{frame}[fragile]{}
%   \begin{theorem}[Stackable Permutations]
%     A permutation $(a_1, \cdots, a_n)$ is stackable \blue{(on the model $S$)} $\iff$ it is not the case that
%     \[
%       312\text{\it -Pattern}: \fbox{$\texttt{\it out} = \cdots a_i \cdots a_j \cdots a_k: i < j < k \land a_j < a_k < a_i$}
%     \]
%   \end{theorem}
% 
%   \vspace{0.30cm}
%   \begin{proof}[$\nexists \;312\text{-Pattern} \Longrightarrow \text{stackable}$]
%     \centerline{According to our algorithm and by contradiction.}
% 
%     \[
%       a_j \notin \texttt{in} \land a_j \;!\!= \texttt{top}(S) \implies \exists k > j: a_k > a_j
%     \]
% 
%     \[
%       a_j, a_k \implies \exists i < j (< k): a_j < a_k < a_i
%     \]
%   \end{proof}
% \end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{DH 2.12: Stackable Permutations}
    \begin{enumerate}[(a)]
      \setcounter{enumi}{2}
      \item How many permutations of $A_4$ \red{\emph{cannot}} be obtained by a stack?
    \end{enumerate}
  \end{exampleblock}

  \begin{align*}
    &(1, \redoverlay{4}{2-}, \redoverlay{2}{2-}, \redoverlay{3}{2-}), (2, 4, 1, 3), (3, 1, 2, 4), 
    (\redoverlay{3}{2-}, \redoverlay{1}{2-}, 4, \redoverlay{2}{2-}), (3, 4, 1, 2) \\
    &(4, 1, 2, 3), (4, 1, 3, 2), (\redoverlay{4}{2-}, 2, \redoverlay{1}{2-}, \redoverlay{3}{2-}), (4, 2, 3, 1), (4, 3, 1, 2)
  \end{align*}

  \vspace{0.60cm}
  \uncover<3->{\centerline{\red{$Q:$} What about $A_n$?}}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{columns}[b]
    \column{0.50\textwidth}
      \fignocaption{width = 0.90\textwidth}{figs/stack-perm-x}
    \pause
    \column{0.50\textwidth}
      \fignocaption{width = 0.90\textwidth}{figs/stack-perm}
  \end{columns}

  \vspace{1.00cm}
  \pause
  \centerline{\red{$Q:$} Are $S+X$ and $S$ are \redoverlay{\bf equivalent}{4-}?}
  \vspace{0.40cm}
  \uncover<5->{\centerline{\blue{Producing the same set of permutations.}}}
  \vspace{0.40cm}
  \uncover<6->{\centerline{\purple{Accepting the same set of \emph{admissible} operation sequences.}}}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{columns}[b]
    \column{0.50\textwidth}
      \fignocaption{width = 0.90\textwidth}{figs/stack-perm-x}
    \column{0.50\textwidth}
      \fignocaption{width = 0.90\textwidth}{figs/stack-perm}
  \end{columns}

  \vspace{0.40cm}
  \pause
  \begin{proof}[\large By simulations.]
    \begin{columns}[t]
      \pause
      \column{0.45\textwidth}
        Simulate $S$ by $S + X$:
	\begin{itemize}
	  \item \texttt{Push}
	  \item \texttt{Pop}
	\end{itemize}
      \pause
      \column{0.45\textwidth}
        Simulate $S + X$ by $S$:
	\pause
	\[
	  \text{By iterative transformations.}
	\]
    \end{columns}
  \end{proof}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \fignocaption{width = 0.50\textwidth}{figs/stack-perm}

  \[
    (1, 2, 3): \push{}\;\; \pop{}\;\; \push{}\;\; \pop{}\;\; \push{}\;\; \pop{}\;\;
  \]

  \[
    (3, 2, 1): \push{}\;\;\push{}\;\;\push{}\;\;\pop{}\;\;\pop{}\;\;\pop{}\;\;
  \]
  % \[
  %   (3, 2, 5, 6, 1, 4): \push{}\;\;\push{}\;\;\push{}\;\;\pop{}\;\;\pop{}\;\;\push{}\;\;\push{}\;\;\pop{}\;\;\push{}\;\;\pop{}\;\;\pop{}\;\;\pop{}\;\;
  % \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{DH 2.12: Stackable Permutations}
    How many permutations of $\set{1 \cdots n}$ are stackable \blue{on the model $S$}?
  \end{exampleblock}

  \fignocaption{width = 0.50\textwidth}{figs/stack-perm}

  \pause
  \centerline{\red{$Q:$} How many \blue{\emph{admissible}} operation sequences of \purple{``\texttt{Push}''} and \purple{``\texttt{Pop}''}?}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{definition}[Admissible Operation Sequences]
    An operation sequence of \purple{``\texttt{Push}''} and \purple{``\texttt{Pop}''} is \blue{\it admissible} if and only if
    \begin{enumerate}[(i)]
      \pause
      \item $\# \text{ of ``\texttt{Push}''} = n \qquad \# \text{ of ``\texttt{Pop}''} = n$
      \pause
      \item $\forall \text{ prefix}: (\# \text{ of ``\texttt{Pop}''}) \le (\# \text{ of ``\texttt{Push}''})$
    \end{enumerate}
  \end{definition}

  \vspace{0.50cm}
  \pause
  \centerline{\fbox{\# of stackable perms $=$ \# of admissible operation sequences}}

  \pause
  \fignocaption{width = 0.30\textwidth}{figs/broken-chain}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{theorem}
    Different admissible operation sequences correspond to different permutations.
  \end{theorem}

  \vspace{0.30cm}
  \pause
  \begin{proof}
    \begin{align*}
      &\push{}\; \;\push{}\; \;\push{}\; \;\pop{}\; \;\pop{}\; \;\red{\push{}} \cdots \\
      &\push{}\; \;\push{}\; \;\push{}\; \;\pop{}\; \;\pop{}\; \;\red{\pop{}} \cdots \\
    \end{align*}
  \end{proof}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{theorem}
    The number of admissible operation sequences of \texttt{\it \purple{``Push''}} and \texttt{\it \purple{``Pop''}} is ${2n \choose n} - {2n \choose n-1}$.
  \end{theorem}

  \pause
  \begin{proof}[Proof: The Reflection Method]
    \[
      \push{}: \;\rightarrow \qquad \pop{}: \;\uparrow
    \]

    \begin{columns}
      \pause
      \column{0.50\textwidth}
	% \fignocaption{width = 0.90\textwidth}{figs/grid-path}
	\begin{center}
	  \resizebox{0.80\textwidth}{!}{\input{tikz/grid}}
	\end{center}
      \column{0.50\textwidth}
	\uncover<6->{
	  \[
	    \blue{\underbrace{\textcolor{black}{{2n \choose n}}}_{\text{all}}} 
	    - \red{\underbrace{\textcolor{black}{{2n \choose n-1}}}_{\text{inadmissible}}}
	  \]
	}
    \end{columns}
  \end{proof}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \resizebox{0.60\textwidth}{!}{\input{tikz/reflection}}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \resizebox{0.60\textwidth}{!}{\input{tikz/reflection-nplus1}}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \centerline{\Large \href{https://en.wikipedia.org/wiki/Catalan\_number}{Catalan Number}}

  \[
    (3,2,1): ((())) \qquad (1,2,3): ()()()
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \centerline{\Large For more about ``Stackable Permutations'' {\large (Section $2.2.1$)}:}

  \vspace{0.30cm}
  \begin{columns}
    \column{0.45\textwidth}
      \fignocaption{width = 0.60\textwidth}{figs/taocp1}
    \column{0.45\textwidth}
      \fignocaption{width = 0.50\textwidth}{figs/knuth}
  \end{columns}
\end{frame}
%%%%%%%%%%%%%%%