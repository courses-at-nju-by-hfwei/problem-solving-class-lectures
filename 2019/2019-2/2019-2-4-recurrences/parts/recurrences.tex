% recurrences.tex

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    {\teal{\Large Recurrences}}
  \end{center}

  \fig{width = 0.60\textwidth}{figs/fractal-tree}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    T(n) = aT(n/b) + f(n) \quad (a > 0,\; b > 1) 
  \]

  \pause
  \begin{center}
    {\red{Assume that $T(n)$ is constant for sufficiently small $n$.}}
  \end{center}

  \pause
  \vspace{0.30cm}
  \begin{equation*}
    \left.\begin{aligned}
      f(n) \\
      af(\frac{n}{b}) \\
      a^2f(\frac{n}{b^2}) \\
      \vdots \\
	  a^{\log_b n} \red{T(1)} = \Theta(n^{\log_b a})
    \end{aligned}\right\}
    \pause
    \purple{\sum} \pause\;\; \blue{\overset{f(n) \;\text{\it vs. } n^{E}}{=}} \pause
	\left\{\begin{aligned}
      n^{\log_b a},		 \\
      n^{\log_b a}\log n, 	 \\
      f(n),		   \quad \\
    \end{aligned}\right.
    \quad \left.\begin{aligned}
      f(n) &= O(n^{E-\epsilon}) \\
      f(n) &= \Theta(n^E) \\
      f(n) &= \Omega(n^{E+\epsilon}) 
    \end{aligned}\right.
  \end{equation*}

  \uncover<5->{
    \[
      \blue{\boxed{E \triangleq \log_b a}} \quad \text{\it (critical exponent)}
    \]
  }
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{TC 4.5-4: Gap in Mater Theorem}
    \[
      {T(n) = 4T(n/2) + n^2 \log n \pause = \teal{\Theta(n^2 \log^{2} n)}}
    \]
  \end{exampleblock}

  \pause
  \[
    \blue{E \triangleq \log_b a = 2}
  \]
  \[
    f(n) = O(n^{E - \epsilon}) \qquad f(n) = \Theta(n^E) \qquad f(n) = \Omega(n^{E + \epsilon})
  \]

  \pause
  \[
    \red{n^2 \log n = o(n^{2 + \epsilon})}
  \]

  \pause
  \[
    \boxed{f(n) = \Theta(n^{\log_b a} \log^{\red{k}}n) \implies \Theta(n^{\log_b a} \log^{\red{k+1}}n) \qquad \red{(k \ge 0)}}
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{TC Problem 4-3 $(e)$: Gaps in Master Theorem}
    \[
      T(n) = 2T(n/2) + \frac{n}{\log n}
    \]
  \end{exampleblock}

  \pause
  \[
    \blue{E \triangleq \log_b a = 1}
  \]
  \[
    f(n) = O(n^{E - \epsilon}) \qquad f(n) = \Theta(n^E) \qquad f(n) = \Omega(n^{E + \epsilon})
  \]

  \pause
  \[
    \red{\frac{n}{\log n} = \omega(n^{1 - \epsilon})}
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.45\textwidth}{figs/guess}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    T(n) = 2T(n/2) + \frac{n}{\log n}
  \]

  \pause
  \[
    \boxed{T(n) = \Theta(n)}
  \]

  \begin{columns}
    \column{0.50\textwidth}
      \pause
      \[
        T(n) = \Omega(n) \qquad \purple{T(n) \ge cn}
      \]

      \pause
      \begin{align*}
        T(n) &= 2T(n/2) + \frac{n}{\log n} \\
             &\ge 2 c \cdot \frac{n}{2} + \frac{n}{\log n} \\
             &= cn + \frac{n}{\log n}
      \end{align*}

      \pause
      \[
        \purple{c = 1}
      \]
    \column{0.50\textwidth}
      \pause
      \[
        T(n) = O(n) \qquad \teal{T(n) \le cn - d}
      \]

      \pause
      \begin{align*}
        T(n) &= 2T(n/2) + \frac{n}{\log n} \\
             &\le 2 (c \cdot \frac{n}{2} - d) + \frac{n}{\log n} \\
             &= cn + \frac{n}{\log n} - 2d
      \end{align*}

      \pause
      \[
        \teal{\frac{n}{\log n} \le d}
      \]
  \end{columns}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    T(n) = 2T(n/2) + \frac{n}{\log n}
  \]

  \begin{columns}
    \column{0.50\textwidth}
      \pause
      \[
        L(n) = 2L(n/2) + 1 = \Theta(n)
      \]

      % \pause
      % \[
      %   \teal{T(n) = \omega(n)}
      % \]
    \column{0.50\textwidth}
      \pause
      \[
        H(n) = 2H(n/2) + n = \Theta(n \log n)
      \]

      % \pause
      % \[
      %   \teal{T(n) = o(n \log n)}
      % \]
  \end{columns}

  \pause
  \vspace{1.00cm}
  \[
    \red{\boxed{T(n) = \Theta(n \log \log n)}}
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.70\textwidth}{figs/problemoverflow-nloglogn}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{align*}
    T(n) &= 2T(n/2) + \frac{n}{\log n} \\[6pt]
    \onslide<2->{&= 2(2T(\frac{n}{4}) + \frac{\frac{n}{2}}{\log \frac{n}{2}}) + \frac{n}{\log n} \\[6pt]}
    \onslide<3->{&= 2^2 T(\frac{n}{2^2}) + \frac{n}{\log n - 1} + \frac{n}{\log n} \\[6pt]}
    \onslide<4->{&= \ldots \\[6pt]} 
    \onslide<5->{&= 2^k T(\frac{n}{2^k}) + \sum\limits_{i=0}^{k-1} \frac{n}{\log n - i} \\[6pt]}
  \end{align*}

  \vspace{-0.60cm}
  \onslide<6->{
    \[
      \teal{\frac{n}{2^k} = 1 \implies k = \log n}
    \]
  }
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \teal{\frac{n}{2^k} = 1 \implies k = \log n}
  \]

  \begin{align*}
    T(n) &= 2^k T(\frac{n}{2^k}) + \sum\limits_{i=0}^{k-1} \frac{n}{\log n - i} \\[8pt]
    \onslide<2->{&= \Theta(n) + n \sum\limits_{i=0}^{\log n - 1} \frac{1}{\log n - i} \\[8pt]}
    \onslide<3->{&= \Theta(n) + n H_{\log n} \\[8pt]}
    \onslide<4->{&= \Theta(n \log \log n)}
  \end{align*}
\end{frame}
%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    T(n) = 2T(n/2) + \frac{n}{\log n}
  \]

  \pause
  \[
    \teal{\boxed{n = 2^k}}
  \]

  \pause
  \[
    T(2^k) = 2T(2^{k-1}) + \frac{2^k}{k}
  \]

  \pause
  \[
    \frac{T(2^k)}{2^k} = \frac{T(2{k-1})}{2^{k-1}} + \frac{1}{k}
  \]

  \pause
  \[
    \red{\boxed{S(k) \triangleq \frac{T(2^k)}{2^k}}}
  \]

  \pause
  \[
    S(k) = S(k-1) + \frac{1}{k} \pause = H_k = \Theta(\log k)
  \]

  \pause
  \vspace{-0.60cm}
  \[
    \blue{T(n) = \Theta(n \log \log n)}
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \boxed{f(n) = \Theta(n^{\log_b a} \log^{\red{k}}n) \implies \Theta(n^{\log_b a} \log^{\red{k+1}}n) \qquad \red{(k \ge 0)}}
  \]

  \pause
  \begin{center}
    \href{https://en.wikipedia.org/wiki/Master\_theorem\_(analysis\_of\_algorithms)}{\teal{Master theorem @ wiki}}
  \end{center}

  \pause
  \[
    f(n) = \Theta(n^{\log_b a} \log^{\red{k}}n)
  \]

  \pause
  \begin{align*}
    k > -1 &\implies T(n) = \Theta(n^{\log_b a} \log^{k+1} n) \\[8pt]
    k = -1 &\implies T(n) = \Theta(n^{\log_b a} \log \log n) \\[8pt]
    k < -1 &\implies T(n) = \Theta(n^{\log_b a})
  \end{align*}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{exampleblock}{TC Problem 4-3 $(b)$}
%     \[
%       T(n) = 3T(n/3) + \frac{n}{\log n}
%     \]
%   \end{exampleblock}
% \end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{exampleblock}{TC Problem 4-3 $(i)$}
%     \[
%       T(n) = T(n-2) + \frac{1}{\log n}
%     \]
%   \end{exampleblock}
% \end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{exampleblock}{TC Problem 4-3 $(f)$}
%     \[
%       T(n) = T(n/2) + T(n/4) + T(n/8) + n
%     \]
%   \end{exampleblock}
% 
%   \pause
%   \vspace{0.30cm}
%   \begin{center}
%     {By recursion-tree.}
%   \end{center}
% 
%   \pause
%   \[
%     \boxed{\teal{T(n) = \Theta(n)}}
%   \]
% 
%   \pause
%   \vspace{0.50cm}
%   \begin{center}
%     {\red{Prove it by mathematical induction.}}
%   \end{center}
% 
%   \pause
%   \begin{alertblock}{Reference:}
%     {\it ``On the Solution of Linear Recurrence Equations''} by Akra \& Bazzi.
%     \[
%       T(n) = \sum_{i=1}^{k} a_i T(n/b_i) + f(n)
%     \]
%   \end{alertblock}
% \end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
% \begin{frame}{Gaps (Problem 1.2.16)}
%   The regularity condition in Case 3:
%   \[
% 	bf(n/c) \le cf(n), \text{ for some } c < 1 \text{ and sufficiently large } n
%   \]
% 
%   \[
% 	T(n) = T(n/2) + n(2 - \cos n)
%   \]
% 
%   \[
% 	n^{E} = n^0 \quad f(n) = n(2 - \cos n) = \Omega(n^{0 + \epsilon})
%   \]
% 
%   \pause
%   \[
% 	n = 2\pi k (k \text{ odd}) \Rightarrow c \ge \frac{3}{2}
%   \]
% \end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{TC Problem 4-3 $(j)$}
    \begin{align*} 
      \text{T}(n) &= \sqrt{n} \text{T}(\sqrt{n})+n \\
	  &= \teal{n^{\frac{1}{2}} \text{T}\left(n^{\frac{1}{2}} \right)+n} \\
	  \onslide<2->{
		&= n^{\frac{1}{2}}\left( n^{\frac{1}{2^2}} \text{T}\left(n^{\frac{1}{2^2}} \right) + n^{\frac{1}{2}} \right)+n\\
		&= \teal{n^{\frac{1}{2}+\frac{1}{2^2}} \text{T}\left(n^{\frac{1}{2^2}}\right) + 2n} \\
	  }
	  \onslide<3->{
		&= n^{\frac{1}{2}+\frac{1}{2^2}}\left(n^{\frac{1}{2^3}} \text{T}\left(n^{\frac{1}{2^3}}\right) + n^{\frac{1}{2^2}} \right) + 2n\\
		&= \teal{n^{\frac{1}{2}+\frac{1}{2^2}+\frac{1}{2^3}} \text{T}\left(n^{\frac{1}{2^3}}\right) + 3n} \\ 
	  }
	  \onslide<4->{
		&= \cdots \\ 
		&= \red{n^{\sum_{i=1}^{k}\frac{1}{2^i}} \text{T}\left(n^{\frac{1}{2^k}}\right) + kn} \\ 
	  }
    \end{align*}
  \end{exampleblock}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \text{T}(n) = \red{n^{\sum_{i=1}^{k}\frac{1}{2^i}} \text{T}\left(n^{\frac{1}{2^k}}\right) + kn}
  \]

  \fig{width = 0.50\textwidth}{figs/slow-down-zoo}

  \pause
  \[
    \red{n^{\frac{1}{2^k}} = 1}
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    n^{\frac{1}{2^k}} = \red{2} \pause \implies k = \log\log n
  \]

  \pause
  \vspace{-0.30cm}
  \begin{align*} 
    \text{T}(n) &= \red{n^{\sum_{i=1}^{k}\frac{1}{2^i}} \text{T}\left(n^{\frac{1}{2^k}}\right) + kn}\\ 
	    &=n^{\sum_{i=1}^{\log\log n}\frac{1}{2^i}} \text{T}(2) + n \log\log n\\ 
  \end{align*}

  \pause
  \vspace{-0.30cm}
  \[
    \sum_{i=1}^{\log \log n}\frac{1}{2^i} < 1 \implies T(n) = \Theta(n \log \log n)
  \]

  \pause
  \vspace{0.40cm}
  \begin{center}
    {\red{Exercise: Prove it by mathematical induction.}}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \boxed{T(n) = \sqrt{n} T(\sqrt{n}) + n}
  \]

  \pause
  \[
    \frac{T(n)}{n} = \frac{T(\sqrt{n})}{\sqrt{n}} + 1
  \]

  \pause
  \[
    \red{n \leftrightarrow 2^m}
  \]

  \pause
  \[
    \frac{T(2^m)}{2^m} = \frac{T(2^{m/2})}{2^{m/2}} + 1
  \]

  \pause
  \[
    \red{S(m) \leftrightarrow \frac{T(2^m)}{2^m}}
  \]

  \pause
  \[
    S(m) = S(m/2) + 1 = \pause \Theta(\log m)
  \]

  \pause
  \vspace{-0.60cm}
  \[
    \boxed{\teal{T(n) = n \log \log n}}
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{TC 4.4-5}
    \begin{center}
      To determine a \red{good} asymptotic upper bound.
    \end{center}

    \[
      T(n) = T(n-1) + T(n/2) + n
    \]
  \end{exampleblock}

  \pause
  \fig{width = 0.40\textwidth}{figs/tc-yan-exponential}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.35\textwidth}{figs/tc-yan-python}

  \vspace{0.30cm}
  \fig{width = 0.80\textwidth}{figs/tc-yan-strange}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.85\textwidth}{figs/tc-solution}

  \begin{center}
    \href{https://math.stackexchange.com/a/475154/51434}{\teal{solution @ math.stackexchange}}
  \end{center}

  \pause
  \vspace{0.50cm}
  \[
    T(n) = T(n-1) + T(n/2) + n
  \]

  \pause
  \[
    \blue{T(n) = -2(n + 2)}
  \]
\end{frame}
%%%%%%%%%%%%%%%