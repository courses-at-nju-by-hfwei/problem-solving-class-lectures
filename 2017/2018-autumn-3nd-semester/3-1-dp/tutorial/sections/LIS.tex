% file: sections/LIS.tex

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{Longest Increasing Subsequence (Problem $15.4$-$5$)}
    \[
      A[1 \ldots n] 
    \]
    \[
      5,\; 2,\; 8,\; 6,\; 3,\; 6,\; 9,\; 7 
    \]

    \vspace{0.20cm}
    \begin{center}
      Find (the length of) a longest increasing (non-decreasing) subseqence.
    \end{center}
    \[
      5,\; \red{2},\; 8,\; 6,\; \red{3},\; \red{6},\; \red{9},\; 7 
    \]
  \end{exampleblock}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    L(i): \hl{yellow}{\text{ the length of an LIS of $A[1 \ldots i]$}}
  \]
  \[
    L(n)
  \]

  \pause
  \vspace{0.30cm}
  \[
    \text{\red{\fbox{\it Is $A[i]$ in this LIS of $A[1 \cdots i]$?}}}
  \]

  \pause
  \vspace{0.30cm}
  \[
    L(i) = \max \Big(\underbrace{\blue{L(i-1)}}_{\blue{\text{NO}}},
      \uncover<4->{\underbrace{\red{1 + \max_{j < i \;\land\; A[j] \le A[i]} L(j)}}_{\red{\text{YES}}}}\Big)
  \]

  \only<5->{
    \fignocaption{width = 0.25\textwidth}{figs/wrong}
  }
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    L(i): \hl{yellow}{\text{ the length of an LIS \red{\it ending with} $A[i]$}}
  \]
  \[
    \max\limits_{i} L(i)
  \]

  \pause
  \begin{center}
    \red{\fbox{\it What is the previous element?}}
  \end{center}

  \pause
  \[
    L(i) = 1 + \max_{j < i \;\land\; A[j] \le A[i]} L(j)
  \]

  \pause
  \[
    L(1) = 1
  \]

  \pause
  \[
    O(n^2) = \Theta(n) \cdot O(n)
  \]
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \text{LIS(A)} = \text{LCS} \Big(A, \red{\textsc{Sort}(A)} \Big)
  \]

  \pause
  \[
    O(n^2) = O(n \log n) + O(n^2)
  \]
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{exampleblock}{Longest Increasing Subsequence (Problem $15.4$-$6$)}
    \[
      O(n \log n)
    \]
  \end{exampleblock}

  \begin{columns}
    \pause
    \column{0.50\textwidth}
      \fignocaption{width = 0.75\textwidth}{figs/nanjing-subway}
    \pause
    \column{0.50\textwidth}
      \fignocaption{width = 0.55\textwidth}{figs/qrcode-quora-lis-answer}
      \centerline{Answer by \blue{Eugene Yarovoi} @ \blue{Quora}}
  \end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \red{E[l]} = \set{\text{\it all increasing subsequences of length $l$}}
  \]

  \pause

  \input{algs/LIS-all}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \red{E[l]} = \set{\text{\it all increasing subsequences of length $l$}}
  \]

  \pause
  \[
    \langle 3\quad 9\quad 11\quad 13 \rangle
  \]

  \[
    \langle 4\quad 6\quad 10\quad 15 \rangle
  \]

  \[
    \langle 2\quad 5\quad 12\quad 18 \rangle
  \]

  \pause
  \[
    \red{\Big|E[l]\Big| = 1}: \text{\it the one with the \red{\it smallest} ending number}
  \]
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \input{algs/LIS-one}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \[
    \red{E[l]} = \set{\text{\it all increasing subsequences of length $l$}}
  \]

  \[
    \red{\Big|E[l]\Big| = 1}: \text{\it the one with the \red{\it smallest} ending number}
  \]

  \pause
  \[
    \langle 2\quad 8\quad 15 \rangle
  \]
  
  \[
    \langle 4\quad 6\quad 11\quad 13 \rangle
  \]

  \[
    \langle 3\quad 9\quad 11\quad 12\quad 13 \rangle
  \]

  \pause
  \[
    \forall i < j: \text{\it the ending number of } E[i] \;\red{<}\; \text{\it the ending number of } E[j]
  \]
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \input{algs/LIS-binary-search}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    {\Large \it \teal{Extending}} \\[6pt] \pause
    {\large \it by looking at only \red{the ending number} of the inc. subseq}
  \end{center}

  \pause
  \input{algs/LIS-ending-number}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \input{algs/LIS-nlogn}
% \end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  % \[
  %   \langle 0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15 \rangle
  % \]

  % \animategraphics[autoplay, loop, height = 5cm]{1}{figs/LISDemo/LISDemo}{0}{33}
  % \transduration<0-33>{0}
  % \multiinclude[<+->][format=png, graphics = {width = 0.40\textwidth}]{figs/LISDemo/LISDemo}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

% \begin{gather*}
%   \red{E[l]} = \hl{yellow}{\text{the \red{\it smallest ending number} for the inc. subseq.}} \\
%     \hl{yellow}{\text{of length $l$ using $A[1 \cdots i]$}}
% \end{gather*}
